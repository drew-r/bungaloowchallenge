var bcrypt = require('bcrypt');

SALT_WORK_FACTOR = 10;

exports.hashPassword = function(password, cb){
	bcrypt.genSalt(SALT_WORK_FACTOR, function(err, salt) {
		if (err) return cb(err);

		bcrypt.hash(password, salt, function(err,hash) {
			cb(null,hash);			
		});

	});
};

exports.testPassword = function(candidate, stored, cb){
	bcrypt.compare(candidate, stored, function(err, isMatch){
		if (err) return cb(err);
		cb(null,isMatch);
	});
};




